<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>NettY | Little Monste'Blog</title><meta name="author" content="小怪兽"><meta name="copyright" content="小怪兽"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Netty"><meta property="og:type" content="article"><meta property="og:title" content="NettY"><meta property="og:url" content="http://example.com/2024/12/02/studyDiary/Netty/index.html"><meta property="og:site_name" content="Little Monste&#39;Blog"><meta property="og:description" content="Netty"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://pic1.imgdb.cn/item/68455fb458cb8da5c83a2a9c.png"><meta property="article:published_time" content="2024-12-02T00:00:00.000Z"><meta property="article:modified_time" content="2024-12-02T00:00:00.000Z"><meta property="article:author" content="小怪兽"><meta property="article:tag" content="Netty"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://pic1.imgdb.cn/item/68455fb458cb8da5c83a2a9c.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2024/12/02/studyDiary/Netty/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"NettY",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-12-02 00:00:00"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise(((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)})),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/_custom/custom.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"><style>#recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags:before{content:"\A";white-space:pre}#recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags>.article-meta__separator{display:none}</style><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload='this.media="all"'><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Little Monste'Blog" type="application/atom+xml"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{const e=document.getElementById("loading-box"),d=document.body,t=()=>{d.style.overflow="",e.classList.add("loaded")},o=()=>{d.style.overflow="hidden",e.classList.remove("loaded")};o(),window.addEventListener("load",(()=>{t()})),setTimeout((function(){t()}),5e3),document.addEventListener("pjax:send",(()=>{o()})),document.addEventListener("pjax:complete",(()=>{t()}))})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/3.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">42</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">34</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouye"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/index.html"><i class="fa-fw iconfont icon-fenlei"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw iconfont icon-liuyanban"></i> <span>留言板</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于我</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/schedule/notes.html"><i class="fa-fw iconfont icon-liaotian"></i> <span>碎碎念</span></a></li><li><a class="site-page child" href="/zc/notes.html"><i class="fa-fw iconfont icon-jinglingqiu"></i> <span>秘密</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('https://pic1.imgdb.cn/item/68455fb458cb8da5c83a2a9c.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Little Monste'Blog"><span class="site-name">Little Monste'Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouye"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/index.html"><i class="fa-fw iconfont icon-fenlei"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw iconfont icon-liuyanban"></i> <span>留言板</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于我</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/schedule/notes.html"><i class="fa-fw iconfont icon-liaotian"></i> <span>碎碎念</span></a></li><li><a class="site-page child" href="/zc/notes.html"><i class="fa-fw iconfont icon-jinglingqiu"></i> <span>秘密</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">NettY</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-02T00:00:00.000Z" title="发表于 2024-12-02 00:00:00">2024-12-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-02T00:00:00.000Z" title="更新于 2024-12-02 00:00:00">2024-12-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>31分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="NettY"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="初识Netty"><a href="#初识Netty" class="headerlink" title="初识Netty"></a>初识Netty</h1><p>Netty 是基于 Java NIO 的异步事件驱动的网络应用框架，使用 Netty 可以快速开发网络应用.Netty 是完全基于 NIO 实现的，所以整个 Netty 都是异步的。<br>Netty其实就是封装的NIO，用于简化NIO操作的。</p><h2 id="Netty初体验"><a href="#Netty初体验" class="headerlink" title="Netty初体验"></a>Netty初体验</h2><p>这里先简单看一下Netty，有很多不懂的地方会慢慢学习和介绍</p><ol><li>导入依赖<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs JAVA">dependency&gt;<br> &lt;groupId&gt;io.netty&lt;/groupId&gt;<br> &lt;artifactId&gt;netty-all&lt;/artifactId&gt;<br> &lt;version&gt;<span class="hljs-number">4.1</span><span class="hljs-number">.35</span>.Final&lt;/version&gt;<br> &lt;/dependency&gt;<br></code></pre></td></tr></table></figure></li><li>服务端<div class="note info flat"><p>这是一个netty的服务端连接配置程序，第一步创建用于处理NIO类型的连接和读写请求的线程池，创建Netty启动对象，配置服务端和客户端的连接类型(NIO),编写具体的业务处理器。启动Netty。</p></div></li></ol><div class="note info flat"><ul><li>EventLoopGroup是线程池，他是继承线程池的</li><li>serverBootstrap.bind(9090) 表示netty的启动，是异步的，加上sync()会进行阻塞</li></ul></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyServer</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//创建处理连接客户端请求的线程组</span><br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">10</span>);<br>        <span class="hljs-comment">//创建只处理客户端读写业务的线程组</span><br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">10</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//这个是netty的启动对象</span><br>            <span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">serverBootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();<br>            <span class="hljs-comment">//对启动对象进行配置</span><br>            serverBootstrap.group(bossGroup,workerGroup)<span class="hljs-comment">//线程组的配置</span><br>                    <span class="hljs-comment">//配置连接通道类型</span><br>                    .channel(NioServerSocketChannel.class)<br>                    <span class="hljs-comment">//队列长度，当线程池满了，请求会暂存到这个队列中</span><br>                    .option(ChannelOption.SO_BACKLOG,<span class="hljs-number">1024</span>)<br>                    <span class="hljs-comment">//处理器，创建通道初始化对象，向该对象添加处理器，处理具体业务</span><br>                    .childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;<br>                        <span class="hljs-meta">@Override</span><br>                        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                            <span class="hljs-comment">//获得pipeline</span><br>                            <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();<br><br>                            <span class="hljs-comment">//添加业务处理handler，这里是自定义的 NettyServerHandler</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyServerHandler</span>());<br>                        &#125;<br>                    &#125;);<br>            System.out.println(<span class="hljs-string">&quot;Netty服务端启动了&quot;</span>);<br>            <span class="hljs-comment">//同步阻塞地启动服务端</span><br>            <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> serverBootstrap.bind(<span class="hljs-number">9090</span>).sync();<br>            <span class="hljs-comment">//只要服务没关闭，该方法会一直阻塞</span><br>            channelFuture.channel().closeFuture().sync();<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">//断开所有线程池中的连接</span><br>            bossGroup.shutdownGracefully();<br>            workerGroup.shutdownGracefully();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>服务端自定义Handler<br>这里是自定义的拦截器 需要去实现Netty框架中的 ChannelInboundHandlerAdapter<div class="note info flat"><ul><li>这里用来处理服务端读写的操作，利用ChannelInboundHandlerAdapter提供的方法实现 读取数据 和写入数据操作</li><li>ByteBuf 是netty提供的抽象类，他是对bytebuff的封装，使我们更容易操作bytebuff</li><li>NIO 中使用的是 bytebuff，Netty封装成了bytebuf。</li></ul></div><a target="_blank" rel="noopener" href="https://imgse.com/i/pAoCPuF"><img src="https://s21.ax1x.com/2024/12/03/pAoCPuF.png" alt="pAoCPuF.png"></a></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyServerHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span> &#123;<br>    <span class="hljs-comment">/**  channelRead方法是当客户端发送来数据时会自动调用</span><br><span class="hljs-comment">     *   ctx含有Channel 和pipeline 的上下文对象</span><br><span class="hljs-comment">     *  msg 客户端发来的数据</span><br><span class="hljs-comment">     */</span><br>     <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">ByteBuf</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> (ByteBuf) msg;<br>        System.out.println(<span class="hljs-string">&quot;从客户端读取到的数据：&quot;</span>+buf);<br>    &#125;<br><br><br><br>    <span class="hljs-comment">/**读取数据后调用的方法：发数据给客户端</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelReadComplete</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>         <span class="hljs-type">ByteBuf</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> Unpooled.copiedBuffer(<span class="hljs-string">&quot;hello world&quot;</span>.getBytes(StandardCharsets.UTF_8));<br>         <span class="hljs-comment">//将数据写入通道中</span><br>         ctx.writeAndFlush(buf);<br>    &#125;<br>    <span class="hljs-comment">// 当出现异常后会调用的方法</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exceptionCaught</span><span class="hljs-params">(ChannelHandlerContext ctx, Throwable cause)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        cause.printStackTrace();<br>        ctx.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li><p>客户端<br>客户端的代码逻辑和服务端整体相同，不同的地方：</p><ul><li>客户端的启动对象是 bootstrap 而不是 servicebootstrap</li><li>客户端启动需要指定 服务端ip<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyClient</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//创建一个线程组用于事件循环</span><br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">eventLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//创建客户端启动对象</span><br>            <span class="hljs-type">Bootstrap</span> <span class="hljs-variable">bootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bootstrap</span>();<br>            <span class="hljs-comment">//设置相关参数</span><br>            bootstrap.group(eventLoopGroup)<br>                    <span class="hljs-comment">//使用NioSocketChannel作为客户端的通道实现</span><br>                    .channel(NioSocketChannel.class)<br>                    <span class="hljs-comment">//创建通道初始化对象并设置handler业务处理器</span><br>                    .handler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;<br>                        <span class="hljs-meta">@Override</span><br>                        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                            <span class="hljs-comment">//获得pipeline</span><br>                            <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();<br>                            <span class="hljs-comment">//添加解码器handler</span><br>                            <span class="hljs-comment">//pipeline.addLast(new StringDecoder());</span><br>                            <span class="hljs-comment">//添加编码器handler</span><br>                            <span class="hljs-comment">//pipeline.addLast(new StringEncoder());</span><br><span class="hljs-comment">//                            pipeline.addLast(new ObjectEncoder());</span><br>                            <span class="hljs-comment">//添加处理器，处理器里面是实现具体业务的</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyClientHandler</span>());<br>                        &#125;<br>                    &#125;);<br>            System.out.println(<span class="hljs-string">&quot;Netty客户端启动了&quot;</span>);<br>            <span class="hljs-comment">//同步阻塞地告知客户端连接的服务器的地址，并启动客户端</span><br>            <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> bootstrap.connect(<span class="hljs-string">&quot;127.0.0.1&quot;</span>, <span class="hljs-number">9090</span>).sync();<br>            <span class="hljs-comment">//阻塞等待完成操作后关闭通道</span><br>            channelFuture.channel().closeFuture().sync();<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            eventLoopGroup.shutdownGracefully();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul></li><li><p>客户端自定义Handler<br>客户端需要实现一个 channelActive方法，该方法会在客户端连接上服务端后自动调用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyClientHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 当客户端完成连接服务器后调用该方法：向服务端写数据</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelActive</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">//使用protostuff编码对象</span><br>        <span class="hljs-type">ByteBuf</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> Unpooled.copiedBuffer(<span class="hljs-string">&quot;hello service&quot;</span>.getBytes(StandardCharsets.UTF_8));<br>        ctx.writeAndFlush(buf);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 当通道有读事件发生时调用的方法：读取服务器返回的数据</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> ctx</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> msg</span><br><span class="hljs-comment">     */</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>       System.out.println(<span class="hljs-string">&quot;来自服务器&quot;</span>+ctx.channel().remoteAddress()+<span class="hljs-string">&quot;的消息:&quot;</span>+msg);<br>   &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> ctx</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> cause</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exceptionCaught</span><span class="hljs-params">(ChannelHandlerContext ctx, Throwable cause)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        ctx.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>最终效果<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAoP7wQ"><img src="https://s21.ax1x.com/2024/12/03/pAoP7wQ.png" alt="pAoP7wQ.png"></a><br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAoPqFs"><img src="https://s21.ax1x.com/2024/12/03/pAoPqFs.png" alt="pAoPqFs.png"></a></p></li></ol><h1 id="NIO基础概念补充"><a href="#NIO基础概念补充" class="headerlink" title="NIO基础概念补充"></a>NIO基础概念补充</h1><p>Netty的底层实现都是由NIO来实现的，没有学过NIO，去学Netty还是有点吃力，来补充一下NIO的基础概念<br>首先看NIO的实现原理图:<br>客户端和服务端会先建立连接，然后通过各自的Channel注册到Selector(多路复用器中)，当某一个客户端有读写请求时，Selector会在已经注册的Channel中根据SelectionKey查找具体时哪一个客户端的Channel发起的请求，并进行处理。<br></p><div class="note info flat"><p>SelectionKey 是Channel在Selector中注册后，Selector为Channel生成的标识 类似于id</p></div><br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAoijNd"><img src="https://s21.ax1x.com/2024/12/03/pAoijNd.jpg" alt="pAoijNd.jpg"></a><p></p><h2 id="epoll"><a href="#epoll" class="headerlink" title="epoll"></a>epoll</h2><p>当某一个客户端有请求时，Selector会查找该客户端的Channel，查找的方法有三种：</p><ul><li>Selector.select()</li><li>Selector.poll()</li><li>Selector.epoll()</li></ul><div class="table-container"><table><thead><tr><th>查找方法</th><th>操作方式</th><th>底层实现</th><th>IO效率</th><th>最大值</th></tr></thead><tbody><tr><td>select</td><td>遍历</td><td>数组</td><td>遍历数组中的所有Channel,效率差</td><td>有上限</td></tr><tr><td>poll</td><td>遍历</td><td>链表</td><td>遍历来链表中的Channel，效率差</td><td>无上限</td></tr><tr><td>epoll</td><td>回调</td><td>哈希表</td><td>操作系统回调就绪状态事件</td><td>无上限</td></tr></tbody></table></div><h1 id="Netty基础知识"><a href="#Netty基础知识" class="headerlink" title="Netty基础知识"></a>Netty基础知识</h1><h2 id="Netty线程模型"><a href="#Netty线程模型" class="headerlink" title="Netty线程模型"></a>Netty线程模型</h2><p>当有客户端向服务端连接时，BossGroup中的NioEventLoop中的Selector会调用select方法并为该客户端生成一个 processSelectedKeys ,并注册到Worker Group中，此时客户端和服务端会建立一个Channel(通道)，标识为 processSelectedKeys，且注册到了Worker Group，当客户端有读写请求时，Worker Group会调用select,根据processSelectedKeys找出是哪个通道发起的读写请求，并交给Pipeline处理具体的读写业务逻辑<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAokCGR"><img src="https://s21.ax1x.com/2024/12/03/pAokCGR.png" alt="pAokCGR.png"></a></p><h2 id="Bootstrap"><a href="#Bootstrap" class="headerlink" title="Bootstrap"></a>Bootstrap</h2><p>Bootstrap是Netty的启动程序，⼀个Netty应⽤通常由⼀个Bootstrap开始。Bootstrap的主要作⽤是配置Netty程序，串联Netty的各个组件。</p><ul><li>Bootstrap: 客户端的启动程序</li><li>ServerBootstrap：服务端启动程序</li></ul><p>例如：<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-comment">//这个是netty的启动对象</span><br>           <span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">serverBootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();<br>           <span class="hljs-comment">//对启动对象进行配置</span><br>           serverBootstrap.group(bossGroup,workerGroup)<span class="hljs-comment">//线程组的配置</span><br>                   <span class="hljs-comment">//配置连接通道类型</span><br>                   .channel(NioServerSocketChannel.class)<br>                   <span class="hljs-comment">//队列长度，当线程池满了，请求会暂存到这个队列中</span><br>                   .option(ChannelOption.SO_BACKLOG,<span class="hljs-number">1024</span>)<br>                   <span class="hljs-comment">//处理器，创建通道初始化对象，向该对象添加处理器，处理具体业务</span><br>                   .childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;<br>                       <span class="hljs-meta">@Override</span><br>                       <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                           <span class="hljs-comment">//获得pipeline</span><br>                           <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();<br><br>                           <span class="hljs-comment">//添加业务处理handler，这里是自定义的 NettyServerHandler</span><br>                           pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyServerHandler</span>());<br>                       &#125;<br>                   &#125;);<br></code></pre></td></tr></table></figure><p></p><h2 id="Future和ChannelFuture"><a href="#Future和ChannelFuture" class="headerlink" title="Future和ChannelFuture"></a>Future和ChannelFuture</h2><p>Netty的所有操作都是异步的，即不能⽴刻得知消息是否被正确处理。因此需要通过Future和ChannelFuture来注册监听器，当操作执⾏成果或者失败来调⽤具体的监听器。</p><ul><li>Future通过sync⽅法来获得同步执⾏的效果。</li><li>ChannelFuture是Future的⼦类，提供了针对于Channel的异步监听操作<br>ChannelFuture 提供了多种监听器的使用，例如在服务端代码进行改造<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs JAVA">            <span class="hljs-comment">//注释的代码是阻塞的，我们不用阻塞的方法，然后添加监听器，并体会异步</span><br><span class="hljs-comment">//            ChannelFuture channelFuture = serverBootstrap.bind(9090).sync();</span><br>            <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> serverBootstrap.bind(<span class="hljs-number">9090</span>);<br>            channelFuture.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelFutureListener</span>() &#123;<br>                <span class="hljs-meta">@Override</span><br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operationComplete</span><span class="hljs-params">(ChannelFuture channelFuture)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                    <span class="hljs-keyword">if</span> (channelFuture.isSuccess())&#123;<br>                        System.out.println(<span class="hljs-string">&quot;启动成功&quot;</span>);<br>                    &#125;<span class="hljs-keyword">else</span> &#123;<br>                        System.out.println(<span class="hljs-string">&quot;启动失败&quot;</span>);<br>                    &#125;<br>                &#125;<br>            &#125;);<br>            System.out.println(<span class="hljs-string">&quot;=========&quot;</span>);<br>            <span class="hljs-comment">//只要服务没关闭，该方法会一直阻塞</span><br>            channelFuture.channel().closeFuture().sync();<br></code></pre></td></tr></table></figure>结果如下， ====比启动成功先输出，说明了程序的异步的效果，并监听到了Netty启动成功<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAokco4"><img src="https://s21.ax1x.com/2024/12/03/pAokco4.png" alt="pAokco4.png"></a><h2 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a>Channel</h2>Channel是Netty⽹络通信的重要组件，⽤于执⾏⽹络IO操作.<div class="note info flat"><p>Channel更像是用来描述 客户端和服务端连接的通道，通道中有很多的Handler，其中包括我们自定义的Handler 用于处理业务</p></div>Channel具备以下能⼒：</li><li>获得当前⽹络连接通道的状态</li><li>⽹络连接的配置参数</li><li>提供异步的⽹络IO操作，⽐如建⽴连接、绑定端⼝、读写操作等</li><li>获得ChannelFuture实例，并注册监听器到ChannelFuture上，⽤于监听IO操作的成功、失败、取消时的事件回调。<br>Channel具体的实现类有以下⼏种：</li><li>NioSocketChannel: 异步的客户端TCP Socket连接通道</li><li>NioServerSocketChannel：异步的服务端TCP Socket连接通道</li><li>NioDatagramChannel：异步的UDP连接通道</li><li>NioSctpChannel：异步的客户端Sctp连接通道</li><li>NioSctpServerChannel：异步的服务端Sctp连接通道<h2 id="ChannelHandler"><a href="#ChannelHandler" class="headerlink" title="ChannelHandler"></a>ChannelHandler</h2>ChannelHandler⽤于处理拦截IO事件，往往在ChannelHandler中可以加⼊业务处理逻辑。ChannelHandler执⾏完后会将IO事件转发到ChannelPipeline中的下⼀个处理程序。<div class="note info flat"><p>信息提示 我们自定义的Handler其实就是 ChannelHandler的子类</p></div><h2 id="ChannelPipeline"><a href="#ChannelPipeline" class="headerlink" title="ChannelPipeline"></a>ChannelPipeline</h2>ChannelPipeline是⼀个双向链表，其中保存着多个ChannelHandler。ChannelPipeline实现了⼀种⾼级形式的过滤器模式，在IO操作时发⽣的⼊站和出站事件，会导致ChannelPipeline中的多个ChannelHandler被依次调⽤<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAoNwsf"><img src="https://s21.ax1x.com/2024/12/04/pAoNwsf.png" alt="pAoNwsf.png"></a><h2 id="Netty的编解码"><a href="#Netty的编解码" class="headerlink" title="Netty的编解码"></a>Netty的编解码</h2>编解码是什么？例如 客户端向服务端发送了一句 “你好，服务端”,但这句话在传输过程中是以二进制形式进行传输的，所以在发送之前会进行编码，将这句话编码成二进制，服务端所收到的消息也是二进制的，所以需要解码成 “你好，服务端”。<h3 id="入站与出站"><a href="#入站与出站" class="headerlink" title="入站与出站"></a>入站与出站</h3>ChannelHandler⽤于处理⼊站和出站数据。</li><li>ChannelHandler的实现类ChannelInboundHandlerAdapter表示⼊站程序</li><li>ChannelHandler的实现类ChannelOutboundHandlerAdapter表示出站程序。</li><li>⼀个Channel包含⼀个ChannelPipeline，⽽ChannelPipeline维护着由多个ChannelHandlerContext组成的双向链表。且每个ChannelHandlerContext内包含⼀个ChannelHandler<br>⼊站：⽆论是客户端还是服务端，对应着ChannelPipeline中链表的tail尾部。如<br>果是接收数据，则为⼊站事件。即数据会从head到tail的过程，会依次经历多个<br>ChannelHandler。<br>出站：如果发⽣的是发送数据的事件，则数据会从tail尾部发送到head头部，这<br>个过程中会先后经历多个ChannelHandler<h3 id="编解码器"><a href="#编解码器" class="headerlink" title="编解码器"></a>编解码器</h3></li></ul><div class="table-container"><table><thead><tr><th>类型</th><th>编码器</th><th>解码器</th><th>备注</th></tr></thead><tbody><tr><td>String</td><td>StringEncoder</td><td>StringDncoder</td><td></td></tr><tr><td>Object</td><td>ObjectEncoder</td><td>ObjectDncoder</td><td></td></tr><tr><td>服务端处理http请求</td><td>HttpResponseEncoder</td><td>HttpRequestDecoder</td><td>HttpServerCodec整合了编解码器</td></tr><tr><td>客户端处理http请求</td><td>HttpResponseEncoder</td><td>HttpRequestDecoder</td><td>HttpClientCodec整合了编解码器</td></tr></tbody></table></div><div class="note info flat"><p>String类型编解码器适用于字符串。<br>Object类型的编码器可以用于对象类型。但是对象类型必须实现序列化</p></div><p>我们来看ObjectEncoder的源码分析</p><ul><li>可以看到encode编码方法需要的是 Serializable类型的msg，所以所传对象需要实现Serializable。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-meta">@Sharable</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectEncoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">MessageToByteEncoder</span>&lt;Serializable&gt; &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">byte</span>[] LENGTH_PLACEHOLDER = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">4</span>];<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ObjectEncoder</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">encode</span><span class="hljs-params">(ChannelHandlerContext ctx, Serializable msg, ByteBuf out)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">startIdx</span> <span class="hljs-operator">=</span> out.writerIndex();<br>        <span class="hljs-type">ByteBufOutputStream</span> <span class="hljs-variable">bout</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteBufOutputStream</span>(out);<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oout</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            bout.write(LENGTH_PLACEHOLDER);<br>            oout = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CompactObjectOutputStream</span>(bout);<br>            oout.writeObject(msg);<br>            oout.flush();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-keyword">if</span> (oout != <span class="hljs-literal">null</span>) &#123;<br>                oout.close();<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                bout.close();<br>            &#125;<br><br>        &#125;<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">endIdx</span> <span class="hljs-operator">=</span> out.writerIndex();<br>        out.setInt(startIdx, endIdx - startIdx - <span class="hljs-number">4</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>如何配置编码器，很简单在Pipeline中添加即可<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs JAVA">  serverBootstrap.group(bossGroup,workerGroup)<br>                    .channel(NioServerSocketChannel.class)<br>                    .childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;<br>                        <span class="hljs-meta">@Override</span><br>                        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                            <span class="hljs-comment">//获得pipeline</span><br>                            <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();<br>                            <span class="hljs-comment">//添加解码器handler</span><br><span class="hljs-comment">//                            pipeline.addLast(new StringDecoder());</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectDecoder</span>(Integer.MAX_VALUE, ClassResolvers.cacheDisabled(<span class="hljs-literal">null</span>)));<br>                            <span class="hljs-comment">//添加编码器handler</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectEncoder</span>());<br>                            <span class="hljs-comment">//添加业务处理handler</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyServerHandler</span>());<br>                        &#125;<br>                    &#125;);<br>            System.out.println(<span class="hljs-string">&quot;Netty服务端启动了&quot;</span>);<br></code></pre></td></tr></table></figure><h3 id="Protostuff提升编解码速度"><a href="#Protostuff提升编解码速度" class="headerlink" title="Protostuff提升编解码速度"></a>Protostuff提升编解码速度</h3></li></ul><ol><li>引入依赖<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs JAVA">&lt;!--protostuff--&gt;<br>     &lt;dependency&gt;<br>         &lt;groupId&gt;com.dyuproject.protostuff&lt;/groupId&gt;<br>         &lt;artifactId&gt;protostuff-api&lt;/artifactId&gt;<br>         &lt;version&gt;<span class="hljs-number">1.0</span><span class="hljs-number">.10</span>&lt;/version&gt;<br>     &lt;/dependency&gt;<br>     &lt;dependency&gt;<br>         &lt;groupId&gt;com.dyuproject.protostuff&lt;/groupId&gt;<br>         &lt;artifactId&gt;protostuff-core&lt;/artifactId&gt;<br>         &lt;version&gt;<span class="hljs-number">1.0</span><span class="hljs-number">.10</span>&lt;/version&gt;<br>     &lt;/dependency&gt;<br>     &lt;dependency&gt;<br>         &lt;groupId&gt;com.dyuproject.protostuff&lt;/groupId&gt;<br>         &lt;artifactId&gt;protostuff-runtime&lt;/artifactId&gt;<br>         &lt;version&gt;<span class="hljs-number">1.0</span><span class="hljs-number">.11</span>&lt;/version&gt;<br>     &lt;/dependency&gt;<br></code></pre></td></tr></table></figure></li><li>使用Protostuff工具提升编解码，就不再需要在Pipeline中添加编解码大的handler了，而是在对应的发送接收消息的方法中使用<br>例如在客户端发消息的方法中：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * 当客户端完成连接服务器后调用该方法：向服务端写数据</span><br><span class="hljs-comment">  */</span><br> <span class="hljs-meta">@Override</span><br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelActive</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>     <span class="hljs-comment">//使用protostuff编码对象</span><br>     <span class="hljs-type">ByteBuf</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> Unpooled.copiedBuffer(ProtostuffUtil.serialize(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-number">1001L</span>,<span class="hljs-string">&quot;小明&quot;</span>)));<br>     ctx.writeAndFlush(buf);<br> &#125;<br></code></pre></td></tr></table></figure><h1 id="Netty-实现简单群聊"><a href="#Netty-实现简单群聊" class="headerlink" title="Netty 实现简单群聊"></a>Netty 实现简单群聊</h1><h2 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h2>服务端用来接收客户端所发来的请求，当客户端连上服务端时，会通知其他客户端，有客户端上线了</li><li>第一步编写服务端配置代码 这一步配置代码几乎时固定不变的<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatServer</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);<br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">serverBootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();<br>            <span class="hljs-comment">//配置参数</span><br>            serverBootstrap.group(bossGroup,workerGroup)<br>                    .channel(NioServerSocketChannel.class)<br>                    .option(ChannelOption.SO_BACKLOG,<span class="hljs-number">1024</span>)<br>                    .childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;<br>                        <span class="hljs-meta">@Override</span><br>                        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                            <span class="hljs-comment">//获得pipeline</span><br>                            <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();<br>                            <span class="hljs-comment">//添加handler</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringDecoder</span>());<br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringEncoder</span>());<br>                            <span class="hljs-comment">//添加业务处理handler</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatServerHandler</span>());<br>                        &#125;<br>                    &#125;);<br>            System.out.println(<span class="hljs-string">&quot;聊天室启动了...&quot;</span>);<br>            <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> serverBootstrap.bind(<span class="hljs-number">9090</span>).sync();<br>            channelFuture.channel().closeFuture().sync();<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            bossGroup.shutdownGracefully();<br>            workerGroup.shutdownGracefully();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li>第二步编写Handler<div class="note info flat"><p>这一步也是最重要的一步。这里的自定义的Handler是实现的 SimpleChannelInboundHandler 而不是之前提到的ChannelInboundHandlerAdapter。其实并没有很大区别，因为SimpleChannelInboundHandler是ChannelInboundHandlerAdapter的子类。<br>SimpleChannelInboundHandler在ChannelInboundHandlerAdapter的基础上重写了 channelRead方法，会在channelRead结束后清空内存空间。</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatServerHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SimpleChannelInboundHandler</span>&lt;String&gt; &#123;<br><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">SimpleDateFormat</span> <span class="hljs-variable">sdf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);<br>    <span class="hljs-comment">//存放Channel的容器，而且可以执行对每个channel进行操作的任务，任务由GlobalEventExecutor提供的单线程来执行的。</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">ChannelGroup</span> <span class="hljs-variable">channelGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultChannelGroup</span>(GlobalEventExecutor.INSTANCE);<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 有新的客户端（channel）连接了，将该客户端的上线信息广播给所有其他的客户端</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> ctx</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelActive</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">//得到客户端的channel，</span><br>        <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> ctx.channel();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;客户端-&quot;</span> + channel.remoteAddress() + <span class="hljs-string">&quot;于&quot;</span> + sdf.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()) + <span class="hljs-string">&quot;上线了\n&quot;</span>;<br>        System.out.println(message);<br>        <span class="hljs-comment">//得到其他客户端的channel，向其他客户端发送该客户端的上线信息</span><br>        channelGroup.writeAndFlush(message);<br>        <span class="hljs-comment">//加入到channelGroup中</span><br>        channelGroup.add(channel);<br>    &#125;<br><br>     <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 客户端下线则广播给其他客户端</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> ctx</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelInactive</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> ctx.channel();<br>        <span class="hljs-comment">//生成一个下线的信息</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;客户端-&quot;</span> + channel.remoteAddress() + <span class="hljs-string">&quot;下线了\n&quot;</span>;<br>        System.out.println(message);<br>        <span class="hljs-comment">//广播给其他客户端</span><br>        channelGroup.writeAndFlush(message); <br><br>    &#125;<br><br>     <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 具体的读数据的业务</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead0</span><span class="hljs-params">(ChannelHandlerContext ctx, String msg)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">//获得当前发消息的客户端的channel</span><br>        <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> ctx.channel();<br>        <span class="hljs-comment">//遍历所有的channel</span><br>        channelGroup.forEach(ch -&gt; &#123;<br>            <span class="hljs-keyword">if</span> (channel != ch) &#123;<br>                <span class="hljs-comment">//发给其他客户端</span><br>                ch.writeAndFlush(<span class="hljs-string">&quot;客户端-&quot;</span> + channel.remoteAddress() + <span class="hljs-string">&quot;于&quot;</span> + sdf.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()) + <span class="hljs-string">&quot;说：&quot;</span><br>                        + msg + <span class="hljs-string">&quot;\n&quot;</span>+<span class="hljs-string">&quot;_&quot;</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-comment">//发给当前发消息的客户端（自己）</span><br>                ch.writeAndFlush(<span class="hljs-string">&quot;我于&quot;</span>+ sdf.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()) + <span class="hljs-string">&quot;说：&quot;</span><br>                        + msg + <span class="hljs-string">&quot;\n&quot;</span>+<span class="hljs-string">&quot;_&quot;</span>);<br>            &#125;<br>        &#125;);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2>客户端需要实现的就是发消息和接收消息<div class="note info flat"><p>这里的发消息并不是写在Handler里的</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatClient</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">eventLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Bootstrap</span> <span class="hljs-variable">bootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bootstrap</span>();<br>            bootstrap.group(eventLoopGroup)<br>                    .channel(NioSocketChannel.class)<br>                    .handler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;<br>                        <span class="hljs-meta">@Override</span><br>                        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                            <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();<br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringDecoder</span>());<br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringEncoder</span>());<br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatClientHandler</span>());<br>                        &#125;<br>                    &#125;);<br>            <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> bootstrap.connect(<span class="hljs-string">&quot;127.0.0.1&quot;</span>, <span class="hljs-number">9090</span>).sync();<br>            <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> channelFuture.channel();<br>            <span class="hljs-comment">//发送消息</span><br>            System.out.println(<span class="hljs-string">&quot;欢迎进入小怪兽聊天室&quot;</span>);<br>            <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>            <span class="hljs-keyword">while</span>(scanner.hasNextLine())&#123;<br>                <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> scanner.nextLine();<br>                <span class="hljs-comment">//发送消息到channel</span><br>                channel.writeAndFlush(message);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            eventLoopGroup.shutdownGracefully();<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li>编写Handler<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatClientHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SimpleChannelInboundHandler</span>&lt;String&gt; &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 打印消息在控制台</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> ctx</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> msg</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Exception</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead0</span><span class="hljs-params">(ChannelHandlerContext ctx, String msg)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(msg.trim());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="最终结果"><a href="#最终结果" class="headerlink" title="最终结果"></a>最终结果</h2><a target="_blank" rel="noopener" href="https://imgse.com/i/pATkaC9"><img src="https://s21.ax1x.com/2024/12/05/pATkaC9.png" alt="pATkaC9.png"></a></li></ol><h1 id="粘包和拆包"><a href="#粘包和拆包" class="headerlink" title="粘包和拆包"></a>粘包和拆包</h1><ul><li>粘包<br>缓冲区数据量满了就会作为整体来发送，⽽这个整体中包含了多条业务数据，那这种情况就是粘包</li><li>拆包<br>在缓冲区数据量满的时候，把⼀条数据分成了两次缓冲区发送，这种情况就是拆包。<div class="note info flat"><p>简单来说 粘包就是多条数据被当成一条数据发送出去了，拆包就是一条数据被当成多条数据发送出去了</p></div>例如我们让客户端2号一直发送小怪兽，会发现很多小怪兽会连在一块发送，这就是粘包<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pATGUeg"><img src="https://s21.ax1x.com/2024/12/06/pATGUeg.png" alt="pATGUeg.png"></a></li></ul><h2 id="粘包和拆包的解决方法"><a href="#粘包和拆包的解决方法" class="headerlink" title="粘包和拆包的解决方法"></a>粘包和拆包的解决方法</h2><p>其实解决方法也很简单，无非是传送数据时，不知道每条数据的开始和结束，我们让netty知道每条数据的开始和结束即可<br>Netty为粘包和拆包提供了多个解码器，每个解码器配有相应的分包解决⽅案</p><ol><li>LineBasedFrameDecoder：回⻋换⾏分包，以回⻋换⾏为分包的依据<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs JAVA">pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LineBasedFrameDecoder</span>(<span class="hljs-number">1024</span>))<br></code></pre></td></tr></table></figure></li><li>DelimiterBasedFrameDecoder:特殊分隔符分包，以指定的特殊分隔符为分包依据，局限是消息内容中不能出现特殊分隔符<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs JAVA">pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DelimiterBasedFrameDecoder</span>(<span class="hljs-number">1024</span>,Unpooled.copiedBuffer(<span class="hljs-string">&quot;_&quot;</span>.getBytes())));<br></code></pre></td></tr></table></figure></li><li>FixedLengthFrameDecode：固定⻓度报⽂分包，消息⻓度被指定，不⾜的以空格补⾜。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FixedLengthFrameDecoder</span>(<span class="hljs-number">1024</span>))<br></code></pre></td></tr></table></figure></li><li>⾃定义分包<br>⾃定义分包往往在发送每条数据的时候，将数据的⻓度⼀并发送。⽐如发送的数据的前4个字节⽤来表示消息的实际⻓度，之后根据消息的实际⻓度来获得具体的数据<h2 id="自定义分包拦截器"><a href="#自定义分包拦截器" class="headerlink" title="自定义分包拦截器"></a>自定义分包拦截器</h2>在自定义分包中，其实就是将消息分为两部分，前一部分代表消息占多少个字节，后一部分表示真正的消息，这样在解码器中，我们读取到消息的长度，就可以准确的发送，避免了粘包和拆包</li></ol><ul><li>消息：客户端发送的消息内容</li><li>消息协议：这⼀次消息需要包含两个部分，即消息⻓度和消息内容本身。</li><li>⾃定义消息编码器：消息编码器将客户端发送的消息转换成遵守消息协议的消息，即包含消息⻓度和消息内容的消息</li><li>⾃定义消息解码器：消息解码器根据消息协议的消息⻓度，来获得指定⻓度的消息内容<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pA79kSx"><img src="https://s21.ax1x.com/2024/12/06/pA79kSx.png" alt="pA79kSx.png"></a><h3 id="自定义消息协议"><a href="#自定义消息协议" class="headerlink" title="自定义消息协议"></a>自定义消息协议</h3><div class="note primary flat"><p>这里定义了一个MessageProtocol实体类用来存储消息的长度和消息</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageProtocol</span> &#123;<br>    <span class="hljs-comment">//消息的长度</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> length;<br>    <span class="hljs-comment">//消息的内容</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">byte</span>[] content;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getLength</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> length;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setLength</span><span class="hljs-params">(<span class="hljs-type">int</span> length)</span> &#123;<br>        <span class="hljs-built_in">this</span>.length = length;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">byte</span>[] getContent() &#123;<br>        <span class="hljs-keyword">return</span> content;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setContent</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] content)</span> &#123;<br>        <span class="hljs-built_in">this</span>.content = content;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="再来改进一下客户端的配置代码"><a href="#再来改进一下客户端的配置代码" class="headerlink" title="再来改进一下客户端的配置代码"></a>再来改进一下客户端的配置代码</h3><div class="note primary flat"><p>这里自定义一个业务处理器和一个编码器。当然还可以添加自定义的解码器</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyClient</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">group</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Bootstrap</span> <span class="hljs-variable">bootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bootstrap</span>();<br>            <span class="hljs-comment">//设置相关的参数</span><br>            bootstrap.group(group)<br>                    .channel(NioSocketChannel.class)<br>                    .handler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;<br>                        <span class="hljs-meta">@Override</span><br>                        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                            <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();<br>                            <span class="hljs-comment">//添加处理器，分包编码器</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageEncoder</span>());<br>                            <span class="hljs-comment">//添加具体的业务处理器</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyMessageClientHandler</span>());<br>                        &#125;<br>                    &#125;);<br>            System.out.println(<span class="hljs-string">&quot;客户端启动了&quot;</span>);<br>            <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> bootstrap.connect(<span class="hljs-string">&quot;127.0.0.1&quot;</span>, <span class="hljs-number">9090</span>).sync();<br>            channelFuture.channel().closeFuture().sync();<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            group.shutdownGracefully();<br>        &#125;<br>    &#125;<br><br><br>&#125;<br></code></pre></td></tr></table></figure></li><li>自定义的业务处理器<div class="note info modern"><p>在 channelActive 方法中实现的客户端连上服务端后具体的业务，这里实现一个简单的客户端连上服务端后 发送两百条“小怪兽”的消息，<br>首先就需要将String字符串转成字节，(为什么转成字节，那当然是因为netty中消息在通道中是以byte的形式传送，所以前面才会讲到编解码器，这里转成字节，是为了获取到消息转换成字节的长度)，然后将字节形式的消息封装到MessageProtocol中</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyMessageClientHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SimpleChannelInboundHandler</span>&lt;MessageProtocol&gt; &#123;<br><br>    <span class="hljs-comment">//连接通道创建后要向服务端发送消息</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelActive</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">200</span>; i++) &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;小怪兽&quot;</span>;<br>            <span class="hljs-comment">//创建消息协议对象</span><br>            <span class="hljs-type">MessageProtocol</span> <span class="hljs-variable">messageProtocol</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageProtocol</span>();<br>            <span class="hljs-comment">//封装长度和内容</span><br>            <span class="hljs-type">byte</span>[] content = msg.getBytes(StandardCharsets.UTF_8);<br>            messageProtocol.setLength(content.length);<br>            messageProtocol.setContent(content);<br>            <span class="hljs-comment">//发送消息协议对象，注意此时ctx只能发送Bytebuf数据，因此需要用编码器把它编码成Bytebuf数据</span><br>            ctx.writeAndFlush(messageProtocol);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead0</span><span class="hljs-params">(ChannelHandlerContext ctx, MessageProtocol msg)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="自定义编码器"><a href="#自定义编码器" class="headerlink" title="自定义编码器"></a>自定义编码器</h3>这样客户端的消息就发出去了，消息发出去后会经过编码器,这里需要继承MessageToByteEncoder类并指定泛型<div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>什么？你问我为什么要继承MessageToByteEncoder，因为他是专门为了自定义编码器而生的 ！在这个类里面为我们封装好了encode 编码方法,他很只能的为我们提供了out.writeInt方法用来封装消息的长度， out.writeBytes封装消息。<br>其实在之前提到的StringEncoder,ObjectEncoder 也都实现了 MessageToMessageEncoder</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageEncoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">MessageToByteEncoder</span>&lt;MessageProtocol&gt; &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">encode</span><span class="hljs-params">(ChannelHandlerContext ctx, MessageProtocol msg, ByteBuf out)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        out.writeInt(msg.getLength());<br>        out.writeBytes(msg.getContent());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>以上客户端的代码就简单完成了，再来看服务端<h3 id="服务端-1"><a href="#服务端-1" class="headerlink" title="服务端"></a>服务端</h3>服务端的更改也只是添加了一个业务拦截器和自定义解码器<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyServer</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);<br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">serverBootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();<br>            serverBootstrap.group(bossGroup,workerGroup)<br>                    .channel(NioServerSocketChannel.class)<br>                    .childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;<br>                        <span class="hljs-meta">@Override</span><br>                        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                            <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();<br>                            <span class="hljs-comment">//添加解码器</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageDecoder</span>());<br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyMessageServerHandler</span>());<br>                        &#125;<br>                    &#125;);<br>            System.out.println(<span class="hljs-string">&quot;Netty服务端启动了&quot;</span>);<br>            <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> serverBootstrap.bind(<span class="hljs-number">9090</span>).sync();<br>            channelFuture.channel().closeFuture().sync();<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            bossGroup.shutdownGracefully();<br>            workerGroup.shutdownGracefully();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="自定义解码器"><a href="#自定义解码器" class="headerlink" title="自定义解码器"></a>自定义解码器</h3>解码器就稍微复杂一些，客户端发来的消息经过编码器后最后会以ByteBuf的形式传到服务端的解码器，然后需要判断可读的字节数是否大于4，不大于4说明所传入的消息中并没有数据<div class="note primary flat"><p>这时候就有人要问了，为什么要跟4判断，那当然是因为我们在 MessageProtocol实体类中创建用于存储消息长度的length是int类型的，int类型占4个字节</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageDecoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ByteToMessageDecoder</span> &#123;<br><br>    <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> ctx</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> in 客户端发送来的MessageProtocol编码后的ByteBuf数据</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> out out里的数据会被放行到下一个handler。把解码出来的MessageProtocol放到out里面</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Exception</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decode</span><span class="hljs-params">(ChannelHandlerContext ctx, ByteBuf in, List&lt;Object&gt; out)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;ByteBuf:&quot;</span>+in);<br>        <span class="hljs-comment">//获得前面4个字节的数据 == 描述实际内容的长度</span><br>        <span class="hljs-keyword">if</span>(in.readableBytes()&gt;=<span class="hljs-number">4</span>)&#123;<br>            <span class="hljs-comment">//ByteBuf里面可能有MessageProtocol数据</span><br>            <span class="hljs-keyword">if</span>(length == <span class="hljs-number">0</span>)&#123;<br>                length = in.readInt();<br>            &#125;<span class="hljs-comment">//length =  15</span><br>            <span class="hljs-keyword">if</span>(in.readableBytes()&lt;length)&#123;<br>                <span class="hljs-comment">//说明数据还没到齐，等待下一次调用decode</span><br>                System.out.println(<span class="hljs-string">&quot;当前数据量不够，继续等待&quot;</span>);<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            <span class="hljs-comment">//可读数据量&gt;=length  ==&gt; 意味着这一次的MessageProtocol中的内容已经到齐了</span><br>            <span class="hljs-comment">//创建一个指定length长度的字节数组</span><br>            <span class="hljs-type">byte</span>[] content = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[length];<br>            <span class="hljs-comment">//把ByteBuf里的指定长度的数据读到content数组中</span><br>            in.readBytes(content);<br>            <span class="hljs-comment">//创建MessageProtocol对象并赋值</span><br>            <span class="hljs-type">MessageProtocol</span> <span class="hljs-variable">messageProtocol</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageProtocol</span>();<br>            messageProtocol.setLength(length);<br>            messageProtocol.setContent(content);<br>            <span class="hljs-comment">//传递给下一个handler</span><br>            out.add(messageProtocol);<br>            <span class="hljs-comment">//重置length</span><br>            length = <span class="hljs-number">0</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li>业务Handler<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyMessageServerHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SimpleChannelInboundHandler</span>&lt;MessageProtocol&gt; &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead0</span><span class="hljs-params">(ChannelHandlerContext ctx, MessageProtocol msg)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;---服务器收到的数据---&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;消息的长度：&quot;</span>+msg.getLength());<br>        System.out.println(<span class="hljs-string">&quot;消息的内容：&quot;</span>+<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(msg.getContent(), StandardCharsets.UTF_8));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>以上就是自定义编解码器 效果如下<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pA7CGCR"><img src="https://s21.ax1x.com/2024/12/06/pA7CGCR.png" alt="pA7CGCR.png"></a></li></ul><h1 id="心跳"><a href="#心跳" class="headerlink" title="心跳"></a>心跳</h1><p>Netty在TCP的⻓连接中，客户端定期向服务端发送⼀种特殊的数据包，告知对⽅⾃⼰正常在线，以确保TCP连接的有效性。Netty实现⼼跳的关键需要通过IdleStateHandler。<br></p><div class="note info flat"><p>心跳机制就是为了确保对方正常在线，避免出现客户端虽然连上了服务端，但是长时间不进行操作，会占用浪费资源，而心跳机制就是检测客户端在一定时间内有没有发来数据，如果没有则会断掉该客户端</p></div><p></p><h2 id="实现心跳"><a href="#实现心跳" class="headerlink" title="实现心跳"></a>实现心跳</h2><p>接下来将会展示利用Netty提供的 IdleStateHandler实现心跳机制，这里主要针对服务端，而客户端的主要工作是向服务端发送消息</p><p>这里主要介绍 IdleStateHandler，IdleStateHandler需要四个参数，分别是：</p><ul><li>读空闲：在指定时间间隔内没有从Channel中读到数据，将会创建状态为READER_IDLE的IdleStateEvent对象。</li><li>写空闲：在指定时间间隔内没有数据写⼊到Channel中，将会创建状态为WRITER_IDLE的IdleStateEvent对象。</li><li>读写空闲：在指定时间间隔内Channel中没有发⽣读写操作，将会创建状态为ALL_IDLE的IdleStateEvent对象。</li><li>时间单位：空闲时间单位<div class="note primary flat"><p>如在接下来的示例中，我们对IdleStateHandler的参数分别为3，0，0，秒; 因为这里主要模仿的是客户端向服务端发送消息，服务端需要的是读空闲，并不涉及服务端向客户端发消息所以不要写空闲</p></div></li></ul><ol><li>服务端<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyServer</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);<br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">serverBootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();<br>            serverBootstrap.group(bossGroup,workerGroup)<br>                    .channel(NioServerSocketChannel.class)<br>                    .childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;<br>                        <span class="hljs-meta">@Override</span><br>                        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                            <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();<br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringEncoder</span>());<br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringDecoder</span>());<br>                            <span class="hljs-comment">/*</span><br><span class="hljs-comment">                            IdleStateHandler处理器会在服务端发现有超过3秒没有发生读操作的话会触发超时事件</span><br><span class="hljs-comment">                            创建出IdleStateEvent对象，将该对象交给下一个Handler</span><br><span class="hljs-comment">                             */</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">IdleStateHandler</span>(<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>, TimeUnit.SECONDS));<br>                            <span class="hljs-comment">//HeartbeatServerHandler必须重写userEventTriggered方法，用来做具体的超时的业务处理</span><br>                            pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HeartbeatServerHandler</span>());<br>                        &#125;<br>                    &#125;);<br>            System.out.println(<span class="hljs-string">&quot;Netty服务端启动了&quot;</span>);<br>            <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> serverBootstrap.bind(<span class="hljs-number">9090</span>).sync();<br>            channelFuture.channel().closeFuture().sync();<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            bossGroup.shutdownGracefully();<br>            workerGroup.shutdownGracefully();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li>业务Handler<div class="note warning flat"><p>在IdleStateHandler被成功执行后（你问我怎么才算成功执行，根据我们在服务端给定的参数，可知当客户端3秒内没有发来消息，就会被成功执行），接着会创建出IdleStateEvent对象，将该对象交给下一个Handler。且下一个Handler必须重写userEventTriggered方法。这里在userEventTriggered方法中的业务逻辑为获取IdleStateEvent对象，判断他是什么类型的超时，当连续超时次数达到3次时就会断开连接。<br>当客户端在3秒内发来数据时，IdleStateHandler就不会被执行，会执行自定义Handler中的channelRead0方法，将超市次数置0。</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HeartbeatServerHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SimpleChannelInboundHandler</span>&lt;String&gt; &#123;<br>    <span class="hljs-comment">//读操作的超时次数</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">readIdleTimes</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead0</span><span class="hljs-params">(ChannelHandlerContext ctx, String msg)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        readIdleTimes = <span class="hljs-number">0</span>;<br>        System.out.println(<span class="hljs-string">&quot;服务端收到的心跳：&quot;</span>+msg);<br>        ctx.writeAndFlush(<span class="hljs-string">&quot;服务端已经收到心跳&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">userEventTriggered</span><span class="hljs-params">(ChannelHandlerContext ctx, Object evt)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">IdleStateEvent</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> (IdleStateEvent) evt;<br>        <span class="hljs-keyword">switch</span> (event.state())&#123;<br>            <span class="hljs-keyword">case</span> READER_IDLE:<br>                readIdleTimes++;<br>                System.out.println(<span class="hljs-string">&quot;读超时&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> WRITER_IDLE:<br>                System.out.println(<span class="hljs-string">&quot;写超时&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> ALL_IDLE:<br>                System.out.println(<span class="hljs-string">&quot;读写超时&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br><br>        &#125;<br>        <span class="hljs-comment">//如果超时次数&gt;3 则关闭客户端的连接</span><br>        <span class="hljs-keyword">if</span>(readIdleTimes&gt;<span class="hljs-number">3</span>)&#123;<br>            System.out.println(<span class="hljs-string">&quot;读超时超过3次，关闭连接&quot;</span>);<br>            ctx.writeAndFlush(<span class="hljs-string">&quot;超时关闭&quot;</span>);<br>            ctx.channel().close();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="断线重连"><a href="#断线重连" class="headerlink" title="断线重连"></a>断线重连</h1>断线重连发生在客户端中，分为两种情况，一是第一次连接失败，二是断线了.</li></ol><ul><li>这里是将连接服务端代码抽取成了一个方法，当第一次连接失败后会采用递归的方式进行重连<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyClient</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Bootstrap bootstrap;<br><br>    <span class="hljs-keyword">public</span> Bootstrap <span class="hljs-title function_">getBootstrap</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> bootstrap;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setBootstrap</span><span class="hljs-params">(Bootstrap bootstrap)</span> &#123;<br>        <span class="hljs-built_in">this</span>.bootstrap = bootstrap;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">group</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br>        <span class="hljs-type">Bootstrap</span> <span class="hljs-variable">bootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bootstrap</span>();<br>        <span class="hljs-type">NettyClient</span> <span class="hljs-variable">nettyClient</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyClient</span>();<br>        nettyClient.setBootstrap(bootstrap);<br>        bootstrap.group(group)<br>                .channel(NioSocketChannel.class)<br>                .handler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;<br>                    <span class="hljs-meta">@Override</span><br>                    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                        <span class="hljs-comment">//添加业务处理器，解决连接成功后的服务器断开连接的重连动作</span><br>                        <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();<br>                        pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyReconnectClientHandler</span>(nettyClient));<br>                    &#125;<br>                &#125;);<br>        <span class="hljs-comment">//第一次的连接</span><br>        nettyClient.connect();<br>        <span class="hljs-comment">//阻塞</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            System.in.read();<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">connect</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//连接服务器</span><br>        <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> bootstrap.connect(<span class="hljs-string">&quot;127.0.0.1&quot;</span>, <span class="hljs-number">9090</span>);<br>        <span class="hljs-comment">//异步的知道连接的结果</span><br>        channelFuture.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelFutureListener</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operationComplete</span><span class="hljs-params">(ChannelFuture future)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>                <span class="hljs-type">boolean</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> future.isSuccess();<br>                <span class="hljs-keyword">if</span>(!result)&#123;<br>                    <span class="hljs-comment">//连接失败==》在一定的时间间隔以后重新连接</span><br>                    future.channel().eventLoop().schedule(()-&gt;&#123;<br>                        System.out.println(<span class="hljs-string">&quot;重新连接中...&quot;</span>);<br>                        connect();<br>                    &#125;,<span class="hljs-number">2000</span>, TimeUnit.MILLISECONDS);<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-comment">//连接成功</span><br>                    System.out.println(<span class="hljs-string">&quot;连接服务器成功&quot;</span>);<br>                &#125;<br>            &#125;<br>        &#125;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li>自定义Handler实现断线重连<br>重写 channelInactive方法(该方法会在断开连接后调用)，在该方法中调用封装的<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyReconnectClientHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SimpleChannelInboundHandler</span>&lt;String&gt; &#123;<br><br>    <span class="hljs-keyword">private</span> NettyClient nettyClient;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">NettyReconnectClientHandler</span><span class="hljs-params">(NettyClient nettyClient)</span> &#123;<br>        <span class="hljs-built_in">this</span>.nettyClient = nettyClient;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead0</span><span class="hljs-params">(ChannelHandlerContext ctx, String msg)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;收到服务端的数据：&quot;</span>+msg);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 断线后会调用此方法，重新连接</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> ctx</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Exception</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelInactive</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;服务器断线重连中...&quot;</span>);<br>        nettyClient.connect();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="暂时完结！"><a href="#暂时完结！" class="headerlink" title="暂时完结！"></a>暂时完结！</h1>Netty暂时了解这么多，后续有需要会接着学习零拷贝和源码。</li></ul><h1 id="完结个蛋完结，一堆没学服了。"><a href="#完结个蛋完结，一堆没学服了。" class="headerlink" title="完结个蛋完结，一堆没学服了。"></a>完结个蛋完结，一堆没学服了。</h1><p>本来是为了仿微信的项目的而去学的netty,发现学的netty知识不够，回来继续补</p><h2 id="知识补充"><a href="#知识补充" class="headerlink" title="知识补充"></a>知识补充</h2><h3 id="netty的http"><a href="#netty的http" class="headerlink" title="netty的http"></a>netty的http</h3><ol><li>由于我在做仿微信项目，所以请求其实是从前端通过http协议发送过来的，所以首先需要学习netty为我们提供的httpde编解码器</li></ol><div class="table-container"><table><thead><tr><th>类型</th><th>编码器</th><th>解码器</th><th>备注</th></tr></thead><tbody><tr><td>服务端处理http请求</td><td>HttpResponseEncoder</td><td>HttpRequestDecoder</td><td>HttpServerCodec整合了编解码器</td></tr><tr><td>客户端处理http请求</td><td>HttpResponseEncoder</td><td>HttpRequestDecoder</td><td>HttpClientCodec整合了编解码器</td></tr></tbody></table></div><p>http的编解码也一样，在通道中直接添加即可，编解码器介绍完了，当然http请求也会发生类似粘包拆包的情况，所以下一个问题就是解决http请求发来的消息不完整的问题</p><ol><li>HTTP消息聚合</li></ol><ul><li>处理HTTP时可能接收HTTP消息片段，Netty需要缓冲直到接收完整个消息。要完成的处理HTTP消息，并且内存开销也不会很大，Netty为此提供了HttpObjectAggregator。</li><li>通过HttpObjectAggregator，Netty可以聚合HTTP消息，使用FullHttpResponse和FullHttpRequest到ChannelPipeline中的下一个ChannelHandler，这就消除了断裂消息，保证了消息的完整。<details class="toggle" style="border:1px solid [pink]"><summary class="toggle-button" style="background-color:[pink];color:[fg]">[你问我什么是FullHttpResponse，FullHttpRequest]</summary><div class="toggle-content"><p>http协议中包含发送请求和响应请求为一次完整的过程，当添加HttpObjectAggregator的时候，netty会自动将请求解析为两部分，一部分是请求头，一部分为请求体。利用这一个特点，可以实现校验，让前端发送的请求需要携带token,这样netty就可以获得token,并校验</p></div></details></li></ul><h3 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h3><p>刚才说到了http协议的请求经过一次发送和响应就结束，如果需要实现长连接聊天功能就需要让客户端不断地发http请求，这个方法明显太拉跨，所以webSocket出现了， WebSocket允许数据双向传输，而不需要请求-响应模式。<br>如何使用WebSocket 这就要讲到netty为我们提供的 WebSocketServerProtocolHandler</p><h4 id="WebSocketServerProtocolHandler"><a href="#WebSocketServerProtocolHandler" class="headerlink" title="WebSocketServerProtocolHandler"></a>WebSocketServerProtocolHandler</h4><p>WebSocketServerProtocolHandler 是 Netty 提供的一个 ChannelHandler，用于处理WebSocket协议。它负责升级HTTP请求到WebSocket连接，并且管理WebSocket连接的生命周期。这意味着它能够自动处理握手过程，以及后续的数据帧的编解码工作，使得开发者可以专注于业务逻辑的实现</p><ul><li>简单使用<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-comment">// 添加 WebSocketServerProtocolHandler</span><br>pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketServerProtocolHandler</span>(<br>    <span class="hljs-string">&quot;/ws&quot;</span>, <span class="hljs-comment">// WebSocket 的路径</span><br>    <span class="hljs-literal">null</span>,  <span class="hljs-comment">// Subprotocols (null 表示没有子协议)</span><br>    <span class="hljs-literal">true</span>,  <span class="hljs-comment">// Allow extensions (true 表示允许扩展)</span><br>    <span class="hljs-number">65536</span> * <span class="hljs-number">10</span> <span class="hljs-comment">// Max frame payload length</span><br>));<br><br><span class="hljs-comment">// 添加自己的 ChannelHandler 来处理 WebSocket 消息</span><br>pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TextWebSocketFrameHandler</span>());<br>    <br></code></pre></td></tr></table></figure></li></ul><h3 id="Attribute"><a href="#Attribute" class="headerlink" title="Attribute"></a>Attribute</h3><p>Attribute 他的底层应该是一个Map,Attribute使用来给channel绑定参数的，一个channel可以绑定多个参数。<br>例如： 在一个Handler通过Attribute给channel设置了多个参数，传递给下一个Handler。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-comment">// 获取当前channel的id</span><br><span class="hljs-type">String</span> <span class="hljs-variable">channelId</span> <span class="hljs-operator">=</span> channel.id().toString();<br><span class="hljs-comment">//创建 AttributeKey</span><br><span class="hljs-type">AttributeKey</span> <span class="hljs-variable">attributeKey</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span> (!AttributeKey.exists(channelId)) &#123;<br>    <span class="hljs-comment">// 如果AttributeKey中不存在 当前channel的id 则创建一个</span><br>    attributeKey = AttributeKey.newInstance(channel.id().toString());<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">//如果存在，则获取这个AttributeKey</span><br>    attributeKey = AttributeKey.valueOf(channel.id().toString());<br>&#125; <br><span class="hljs-comment">//查找名为 channel的id 的AttributeKey，给他设置值</span><br>channel.attr(attributeKey).set(userId);<br></code></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者:</span> <span class="post-copyright-info"><a href="http://example.com">小怪兽</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接:</span> <span class="post-copyright-info"><a href="http://example.com/2024/12/02/studyDiary/Netty/">http://example.com/2024/12/02/studyDiary/Netty/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Little Monste'Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Netty/">Netty</a></div><div class="post_share"><div class="social-share" data-image="https://pic1.imgdb.cn/item/68455fb458cb8da5c83a2a9c.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/12/23/studyDiary/%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96/" title="循环依赖"><img class="cover" src="https://pic1.imgdb.cn/item/683fc15758cb8da5c82ad83a.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">循环依赖</div></div></a></div><div class="next-post pull-right"><a href="/2024/11/29/studyDiary/EasyChat/" title="easychat"><img class="cover" src="https://pic.imgdb.cn/item/67444c2d88c538a9b5bba728.webp" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">easychat</div></div></a></div></nav><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/3.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">小怪兽</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">42</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">34</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="iconfont icon-gonggao"></i> <span>公告</span></div><div class="announcement_content">我知道我可能当不了奥特曼了，但我还是会去拯救世界！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9D%E8%AF%86Netty"><span class="toc-number">1.</span> <span class="toc-text">初识Netty</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Netty%E5%88%9D%E4%BD%93%E9%AA%8C"><span class="toc-number">1.1.</span> <span class="toc-text">Netty初体验</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NIO%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5%E8%A1%A5%E5%85%85"><span class="toc-number">2.</span> <span class="toc-text">NIO基础概念补充</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#epoll"><span class="toc-number">2.1.</span> <span class="toc-text">epoll</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Netty%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">3.</span> <span class="toc-text">Netty基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Netty%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="toc-number">3.1.</span> <span class="toc-text">Netty线程模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bootstrap"><span class="toc-number">3.2.</span> <span class="toc-text">Bootstrap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Future%E5%92%8CChannelFuture"><span class="toc-number">3.3.</span> <span class="toc-text">Future和ChannelFuture</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Channel"><span class="toc-number">3.4.</span> <span class="toc-text">Channel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ChannelHandler"><span class="toc-number">3.5.</span> <span class="toc-text">ChannelHandler</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ChannelPipeline"><span class="toc-number">3.6.</span> <span class="toc-text">ChannelPipeline</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Netty%E7%9A%84%E7%BC%96%E8%A7%A3%E7%A0%81"><span class="toc-number">3.7.</span> <span class="toc-text">Netty的编解码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E7%AB%99%E4%B8%8E%E5%87%BA%E7%AB%99"><span class="toc-number">3.7.1.</span> <span class="toc-text">入站与出站</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%A7%A3%E7%A0%81%E5%99%A8"><span class="toc-number">3.7.2.</span> <span class="toc-text">编解码器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Protostuff%E6%8F%90%E5%8D%87%E7%BC%96%E8%A7%A3%E7%A0%81%E9%80%9F%E5%BA%A6"><span class="toc-number">3.7.3.</span> <span class="toc-text">Protostuff提升编解码速度</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Netty-%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%BE%A4%E8%81%8A"><span class="toc-number">4.</span> <span class="toc-text">Netty 实现简单群聊</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">4.1.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">4.2.</span> <span class="toc-text">客户端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E7%BB%88%E7%BB%93%E6%9E%9C"><span class="toc-number">4.3.</span> <span class="toc-text">最终结果</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B2%98%E5%8C%85%E5%92%8C%E6%8B%86%E5%8C%85"><span class="toc-number">5.</span> <span class="toc-text">粘包和拆包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B2%98%E5%8C%85%E5%92%8C%E6%8B%86%E5%8C%85%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95"><span class="toc-number">5.1.</span> <span class="toc-text">粘包和拆包的解决方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%86%E5%8C%85%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">5.2.</span> <span class="toc-text">自定义分包拦截器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B6%88%E6%81%AF%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.2.1.</span> <span class="toc-text">自定义消息协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%8D%E6%9D%A5%E6%94%B9%E8%BF%9B%E4%B8%80%E4%B8%8B%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81"><span class="toc-number">5.2.2.</span> <span class="toc-text">再来改进一下客户端的配置代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BC%96%E7%A0%81%E5%99%A8"><span class="toc-number">5.2.3.</span> <span class="toc-text">自定义编码器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-1"><span class="toc-number">5.2.4.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A7%A3%E7%A0%81%E5%99%A8"><span class="toc-number">5.2.5.</span> <span class="toc-text">自定义解码器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%83%E8%B7%B3"><span class="toc-number">6.</span> <span class="toc-text">心跳</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E5%BF%83%E8%B7%B3"><span class="toc-number">6.1.</span> <span class="toc-text">实现心跳</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%AD%E7%BA%BF%E9%87%8D%E8%BF%9E"><span class="toc-number">7.</span> <span class="toc-text">断线重连</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9A%82%E6%97%B6%E5%AE%8C%E7%BB%93%EF%BC%81"><span class="toc-number">8.</span> <span class="toc-text">暂时完结！</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%8C%E7%BB%93%E4%B8%AA%E8%9B%8B%E5%AE%8C%E7%BB%93%EF%BC%8C%E4%B8%80%E5%A0%86%E6%B2%A1%E5%AD%A6%E6%9C%8D%E4%BA%86%E3%80%82"><span class="toc-number">9.</span> <span class="toc-text">完结个蛋完结，一堆没学服了。</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85"><span class="toc-number">9.1.</span> <span class="toc-text">知识补充</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#netty%E7%9A%84http"><span class="toc-number">9.1.1.</span> <span class="toc-text">netty的http</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebSocket"><span class="toc-number">9.1.2.</span> <span class="toc-text">WebSocket</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSocketServerProtocolHandler"><span class="toc-number">9.1.2.1.</span> <span class="toc-text">WebSocketServerProtocolHandler</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Attribute"><span class="toc-number">9.1.3.</span> <span class="toc-text">Attribute</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/17/InternshipDiary/xxl-job/" title="XXL-JOB"><img src="https://img.cdn1.vip/i/68ca7ef0b115f_1758101232.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="XXL-JOB"></a><div class="content"><a class="title" href="/2025/09/17/InternshipDiary/xxl-job/" title="XXL-JOB">XXL-JOB</a><time datetime="2025-09-17T00:00:00.000Z" title="发表于 2025-09-17 00:00:00">2025-09-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/04/InternshipDiary/%E5%B0%8F%E6%80%AA%E5%85%BD%E7%9A%84%E5%AE%9E%E4%B9%A0%E6%97%A5%E8%AE%B0/" title="小怪兽的实习日记"><img src="https://img.cdn1.vip/i/68b78a9a03a21_1756859034.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="小怪兽的实习日记"></a><div class="content"><a class="title" href="/2025/09/04/InternshipDiary/%E5%B0%8F%E6%80%AA%E5%85%BD%E7%9A%84%E5%AE%9E%E4%B9%A0%E6%97%A5%E8%AE%B0/" title="小怪兽的实习日记">小怪兽的实习日记</a><time datetime="2025-09-04T00:00:00.000Z" title="发表于 2025-09-04 00:00:00">2025-09-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/28/InternshipDiary/jenkins/" title="jenkins"><img src="https://img.cdn1.vip/i/68b12556b3962_1756439894.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="jenkins"></a><div class="content"><a class="title" href="/2025/08/28/InternshipDiary/jenkins/" title="jenkins">jenkins</a><time datetime="2025-08-28T00:00:00.000Z" title="发表于 2025-08-28 00:00:00">2025-08-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/28/InternshipDiary/%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2/" title="java多表分页查询orSQL连表分页查询"><img src="https://img.cdn1.vip/i/68b11983a6dc8_1756436867.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="java多表分页查询orSQL连表分页查询"></a><div class="content"><a class="title" href="/2025/08/28/InternshipDiary/%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2/" title="java多表分页查询orSQL连表分页查询">java多表分页查询orSQL连表分页查询</a><time datetime="2025-08-28T00:00:00.000Z" title="发表于 2025-08-28 00:00:00">2025-08-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/08/studyDiary/%E5%B8%B8%E8%A7%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" title="排序算法总结"><img src="https://pic1.imgdb.cn/item/68956e5558cb8da5c8111b81.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="排序算法总结"></a><div class="content"><a class="title" href="/2025/08/08/studyDiary/%E5%B8%B8%E8%A7%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" title="排序算法总结">排序算法总结</a><time datetime="2025-08-08T00:00:00.000Z" title="发表于 2025-08-08 00:00:00">2025-08-08</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url('https://pic1.imgdb.cn/item/68455fb458cb8da5c83a2a9c.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By 小怪兽</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(()=>{const t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://mytwikoo.littermonste.top/",region:"",onCommentLoaded:()=>{btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null))},o=()=>{"object"==typeof twikoo?setTimeout(t,0):getScript("https://cdn.jsdelivr.net/npm/twikoo@1.6.31/dist/twikoo.all.min.js").then(t)};o()})()</script></div><div class="aplayer no-destroy" data-id="12540889540" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true" data-lrctype="-1"></div>-<script defer src="/live2d-widget/autoload.js"></script><div class="aplayer no-destroy" data-id="12540889540" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true" data-lrctype="-1"></div><script async data-pjax src="/js/custom/floatpanel.js"></script><script async data-pjax src="//at.alicdn.com/t/c/font_4669924_9b2qmyv6ow.js"></script><script src="/js/highlight.min.js"></script><script>hljs.initHighlightingOnLoad()></script><script async data-pjax src="/js/diytitle.js"></script><script defer src="https://cdn.jsdelivr.net/npm/akilar-live2d-widget/autoload.min.js"></script><script id="canvas_nest" defer color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="I,LOVE,YOU" data-fontsize="15px" data-random="false" async></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(btf.removeGlobalFnEvent("pjax"),btf.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script data-pjax>function butterfly_categories_card_injector_config(){var a=document.getElementById("recent-posts");console.log("已挂载butterfly_categories_card"),a.insertAdjacentHTML("afterbegin",'<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover1.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/小怪兽的实习日记/&quot;);" href="javascript:void(0);">小怪兽的实习日记</a><span class="categoryBar-list-count">4</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover2.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/小怪兽的面试题/&quot;);" href="javascript:void(0);">小怪兽的面试题</a><span class="categoryBar-list-count">7</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover3.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/小怪兽的刷题日记/&quot;);" href="javascript:void(0);">小怪兽的刷题日记</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover4.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/学习笔记/&quot;);" href="javascript:void(0);">学习笔记</a><span class="categoryBar-list-count">28</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover5.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/实战项目/&quot;);" href="javascript:void(0);">实战项目</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover6.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/软件设计师/&quot;);" href="javascript:void(0);">软件设计师</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr"></span></li></ul></div></div>')}document.getElementById("recent-posts")&&(location.pathname,1)&&butterfly_categories_card_injector_config()</script><script data-pjax>function butterfly_clock_anzhiyu_injector_config(){var a=document.getElementsByClassName("sticky_layout")[0];console.log("已挂载butterfly_clock_anzhiyu"),a&&a.insertAdjacentHTML("afterbegin",'<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",qweather_key="b16a1fa0e63c46a4b8f28abfb06ae3fe",gaud_map_key="a86138146f6541097ac14c1d4a4843c5",baidu_ak_key="undefined",flag=0,clock_rectangle="112.982279,28.19409",clock_default_rectangle_enable="false",i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_clock_anzhiyu_injector_config()</script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>function butterfly_footer_beautify_injector_config(){var e=document.getElementById("footer-wrap");console.log("已挂载butterfly_footer_beautify"),e.insertAdjacentHTML("beforeend",'<div id="workboard"></div><div id="ghbdages" style="overflow:hidden;max-height:90px;height:auto;text-align:center;margin-top:10px"><div class="swiper-wrapper"><div class="swiper-slide"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v5.4.0"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v3.8.2"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://www.jsdelivr.com/" style="margin-inline:5px" title="本站使用JsDelivr为静态资源提供CDN加速"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&amp;logo=jsDelivr" alt=""/></a></div><div class="swiper-slide"><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="本站采用双线部署，默认线路托管于Vercel"><img src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="本站采用双线部署，联通线路托管于Coding"><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&amp;logo=Codio" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本站项目由Github托管"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></div><div class="swiper-slide"><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></div></div></div><style>a.github-badge:hover:before {display:none}</style>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_footer_beautify_injector_config()</script><script async src="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-footer-beautify/lib/swiperbdage_init.min.js"></script><script data-pjax>function butterfly_swiper_injector_config(){var i=document.getElementById("recent-posts");console.log("已挂载butterfly_swiper"),i.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/10/17/studyDiary/软件设计师错题/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic.imgdb.cn/item/67161400d29ded1a8cfc63e5.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-10-17</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/10/17/studyDiary/软件设计师错题/&quot;);" href="javascript:void(0);" alt="">软件设计师错题</a><div class="blog-slider__text">刷题刷崩溃啦</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/10/17/studyDiary/软件设计师错题/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/09/07/studyDiary/浅学Docker/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/img/Docker.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-09-07</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/09/07/studyDiary/浅学Docker/&quot;);" href="javascript:void(0);" alt="">Docker</a><div class="blog-slider__text">浅学docker</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/09/07/studyDiary/浅学Docker/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/11/29/studyDiary/拦截器/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/683fc0f258cb8da5c82ad2ae.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-29</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/11/29/studyDiary/拦截器/&quot;);" href="javascript:void(0);" alt="">拦截器</a><div class="blog-slider__text">springboot拦截器</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/11/29/studyDiary/拦截器/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/03/06/studyDiary/git合并小技巧/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/683fc17e58cb8da5c82ada59.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-06</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/03/06/studyDiary/git合并小技巧/&quot;);" href="javascript:void(0);" alt="">git合并小技巧</a><div class="blog-slider__text">git</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/03/06/studyDiary/git合并小技巧/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/01/15/studyDiary/git/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/683fc1fd58cb8da5c82ae128.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/01/15/studyDiary/git/&quot;);" href="javascript:void(0);" alt="">git常见命令</a><div class="blog-slider__text">git</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/01/15/studyDiary/git/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/12/02/studyDiary/Netty/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/68455fb458cb8da5c83a2a9c.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-12-02</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/12/02/studyDiary/Netty/&quot;);" href="javascript:void(0);" alt="">NettY</a><div class="blog-slider__text">Netty</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/12/02/studyDiary/Netty/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/06/23/studyDiary/JVM字节码和类加载/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/685e63fb58cb8da5c87758d0.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-06-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/06/23/studyDiary/JVM字节码和类加载/&quot;);" href="javascript:void(0);" alt="">JVM字节码和类加载</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/06/23/studyDiary/JVM字节码和类加载/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/06/23/studyDiary/JVM导学/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/685a569f58cb8da5c86b0c9f.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-06-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/06/23/studyDiary/JVM导学/&quot;);" href="javascript:void(0);" alt="">JVM导学</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/06/23/studyDiary/JVM导学/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/06/30/studyDiary/JVM垃圾回收/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/686247be58cb8da5c87f5895.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-06-30</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/06/30/studyDiary/JVM垃圾回收/&quot;);" href="javascript:void(0);" alt="">JVM垃圾回收</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/06/30/studyDiary/JVM垃圾回收/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/06/27/studyDiary/JVM内存结构/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/6862477558cb8da5c87f586b.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-06-27</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/06/27/studyDiary/JVM内存结构/&quot;);" href="javascript:void(0);" alt="">JVM内存结构</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/06/27/studyDiary/JVM内存结构/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/06/03/studyDiary/JUC/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/683fc0d558cb8da5c82ad112.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-06-03</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/06/03/studyDiary/JUC/&quot;);" href="javascript:void(0);" alt="">JUC编程</a><div class="blog-slider__text">重新认识JUC</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/06/03/studyDiary/JUC/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/11/19/studyDiary/HTML/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/6845600658cb8da5c83a2ad4.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-19</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/11/19/studyDiary/HTML/&quot;);" href="javascript:void(0);" alt="">HTML</a><div class="blog-slider__text">重新认识HTML</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/11/19/studyDiary/HTML/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/01/22/studyDiary/Go微服务/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/67936d58d0e0a243d4f79cb8.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-22</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/01/22/studyDiary/Go微服务/&quot;);" href="javascript:void(0);" alt="">GoZero</a><div class="blog-slider__text">极限速通Gozero</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/01/22/studyDiary/Go微服务/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/01/16/studyDiary/Golang/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/683fc1b058cb8da5c82add29.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-16</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/01/16/studyDiary/Golang/&quot;);" href="javascript:void(0);" alt="">Golang</a><div class="blog-slider__text">带薪学Golang</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/01/16/studyDiary/Golang/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/11/29/studyDiary/EasyChat/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic.imgdb.cn/item/67444c2d88c538a9b5bba728.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-29</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/11/29/studyDiary/EasyChat/&quot;);" href="javascript:void(0);" alt="">easychat</a><div class="blog-slider__text">仿微信项目</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/11/29/studyDiary/EasyChat/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/04/15/studyDiary/ETCD/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/68455f0658cb8da5c83a29fc.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-04-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/04/15/studyDiary/ETCD/&quot;);" href="javascript:void(0);" alt="">etcd</a><div class="blog-slider__text">加强版的redis</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/04/15/studyDiary/ETCD/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/11/11/studyDiary/AOP/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic.imgdb.cn/item/6731cf16d29ded1a8c658db4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/11/11/studyDiary/AOP/&quot;);" href="javascript:void(0);" alt="">AOP</a><div class="blog-slider__text">AOP实现公共字段自动填充</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/11/11/studyDiary/AOP/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/08/08/studyDiary/常见排序算法/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/68956e5558cb8da5c8111b81.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-08-08</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/08/08/studyDiary/常见排序算法/&quot;);" href="javascript:void(0);" alt="">排序算法总结</a><div class="blog-slider__text">排序算法总结</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/08/08/studyDiary/常见排序算法/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/09/07/studyDiary/vue3/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic.imgdb.cn/item/67161427d29ded1a8cfcbda2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-09-07</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/09/07/studyDiary/vue3/&quot;);" href="javascript:void(0);" alt="">vue3</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/09/07/studyDiary/vue3/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/10/09/studyDiary/uniapp/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic.imgdb.cn/item/67161280d29ded1a8cf90d43.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-10-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/10/09/studyDiary/uniapp/&quot;);" href="javascript:void(0);" alt="">uniapp</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/10/09/studyDiary/uniapp/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/04/09/studyDiary/stream/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/68455f2a58cb8da5c83a2a0e.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-04-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/04/09/studyDiary/stream/&quot;);" href="javascript:void(0);" alt="">stream</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/04/09/studyDiary/stream/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/11/16/studyDiary/MYSQL/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic.imgdb.cn/item/67380dbed29ded1a8c492960.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-16</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/11/16/studyDiary/MYSQL/&quot;);" href="javascript:void(0);" alt="">MYSQL进阶</a><div class="blog-slider__text">数据库进阶学习</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/11/16/studyDiary/MYSQL/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/07/17/interview/计网面试题/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/687626f058cb8da5c8b30963.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-07-17</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/07/17/interview/计网面试题/&quot;);" href="javascript:void(0);" alt="">计网面试题</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/07/17/interview/计网面试题/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/07/05/interview/简历面试/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/6868d6ddf8595c5440cf9277.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-07-05</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/07/05/interview/简历面试/&quot;);" href="javascript:void(0);" alt="">简历项目面试题</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/07/05/interview/简历面试/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/07/13/interview/多线程面试/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/6876274f58cb8da5c8b309ba.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-07-13</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/07/13/interview/多线程面试/&quot;);" href="javascript:void(0);" alt="">JAVA多线程面试题</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/07/13/interview/多线程面试/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/07/15/interview/刷题日记/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/68777cb658cb8da5c8ba0f6b.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-07-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/07/15/interview/刷题日记/&quot;);" href="javascript:void(0);" alt="">小怪兽的刷题日记</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/07/15/interview/刷题日记/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/07/18/interview/spring面试/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/687a0c3558cb8da5c8c2cd69.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-07-18</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/07/18/interview/spring面试/&quot;);" href="javascript:void(0);" alt="">spring面试总结</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/07/18/interview/spring面试/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/08/04/interview/redis/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/689052b658cb8da5c8037314.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-08-04</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/08/04/interview/redis/&quot;);" href="javascript:void(0);" alt="">redis面试总结</a><div class="blog-slider__text">redis的面试题</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/08/04/interview/redis/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/07/01/interview/MYSQL/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/685b9c2c58cb8da5c86fac34.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-07-01</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/07/01/interview/MYSQL/&quot;);" href="javascript:void(0);" alt="">MYSQL的面试题</a><div class="blog-slider__text">数据库进阶学习</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/07/01/interview/MYSQL/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/07/11/interview/JAVA基础/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/6870754658cb8da5c89b41bd.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-07-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/07/11/interview/JAVA基础/&quot;);" href="javascript:void(0);" alt="">JAVA基础面试题</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/07/11/interview/JAVA基础/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/04/27/studyDiary/支付/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/683fc1c958cb8da5c82ade6f.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-04-27</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/04/27/studyDiary/支付/&quot;);" href="javascript:void(0);" alt="">第三方支付和项目部署</a><div class="blog-slider__text">通用的支付逻辑</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/04/27/studyDiary/支付/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/09/10/studyDiary/微服务/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic.imgdb.cn/item/66e00170d9c307b7e9d67a8b.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-09-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/09/10/studyDiary/微服务/&quot;);" href="javascript:void(0);" alt="">springcloud</a><div class="blog-slider__text">与微服务的初相遇</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/09/10/studyDiary/微服务/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/12/23/studyDiary/循环依赖/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/683fc15758cb8da5c82ad83a.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-12-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/12/23/studyDiary/循环依赖/&quot;);" href="javascript:void(0);" alt="">循环依赖</a><div class="blog-slider__text">彻底搞懂循环依赖</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/12/23/studyDiary/循环依赖/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2025/03/20/studyDiary/springboot访问静态目录/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/683fc1e658cb8da5c82adfe9.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-20</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2025/03/20/studyDiary/springboot访问静态目录/&quot;);" href="javascript:void(0);" alt="">springboot访问静态图片</a><div class="blog-slider__text">访问静态资源</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2025/03/20/studyDiary/springboot访问静态目录/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/12/23/studyDiary/redis进阶/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic1.imgdb.cn/item/68455f7258cb8da5c83a2a2a.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-12-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/12/23/studyDiary/redis进阶/&quot;);" href="javascript:void(0);" alt="">redis进阶</a><div class="blog-slider__text">redis进阶知识</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/12/23/studyDiary/redis进阶/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/09/03/studyDiary/redis学习/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/img/2.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-09-03</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/09/03/studyDiary/redis学习/&quot;);" href="javascript:void(0);" alt="">redis学习</a><div class="blog-slider__text">这是一个我与redis的故事</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/09/03/studyDiary/redis学习/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/09/23/studyDiary/RabbitMQ/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://pic.imgdb.cn/item/66f15c72f21886ccc0ce8e9e.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-09-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/09/23/studyDiary/RabbitMQ/&quot;);" href="javascript:void(0);" alt="">RabbitMQ消息队列</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/09/23/studyDiary/RabbitMQ/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/09/06/studyDiary/MybatisPlus/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/img/1.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-09-06</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/09/06/studyDiary/MybatisPlus/&quot;);" href="javascript:void(0);" alt="">MybatisPlus</a><div class="blog-slider__text">mybatisplus的引入</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/09/06/studyDiary/MybatisPlus/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script async src="/js/ali_font.js"></script><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration","1.5s"),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset","30"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("flink-list-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__flipInY"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("flink-list-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__animated"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("article-sort-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__slideInRight"),arr[i].setAttribute("data-wow-duration","1.5s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("site-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__flipInY"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("site-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__animated"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>function gitcalendar_injector_config(){document.getElementById("recent-posts").insertAdjacentHTML("afterbegin",'<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>'),console.log("已挂载gitcalendar")}document.getElementById("recent-posts")&&"/"===location.pathname&&(gitcalendar_injector_config(),GitCalendarInit("https://gitcalendar.akilar.top/api?Akilarlxh",["#e4dfd7","#f9f4dc","#f7e8aa","#f7e8aa","#f8df72","#fcd217","#fcc515","#f28e16","#fb8b05","#d85916","#f43e06"],"Akilarlxh"))</script><script async>window.onload=function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.src="/sw-register.js?v="+Date.now(),t.parentNode.insertBefore(e,t)}</script></body></html>